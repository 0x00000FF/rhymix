<!-- css -->
<load target="css/default.css" />

<!-- JS -->
<!--%load_js_plugin("ckeditor")-->
<load target="../../tpl/js/editor_common.js" />
<load target="../../tpl/js/editor.app.js" />
<load target="js/xe_interface.js" />

{@ $css_content = null }
<!--@if($content_font || $content_font_size)-->
	{@ $css_content = '.xe_content.editable p { margin: 0;'. chr(125); }

	{@ $css_content .= ' .xe_content.editable { '}
	<block cond="$content_font">
	{@ $css_content .= 'font-family:' . $content_font . ';';}
	</block>

	<block cond="$content_font_size">
	{@ $css_content .= 'font-size:' . $content_font_size . ';';}
	</block>
	{@ $css_content .= chr(125);}
<!--@endif-->

<div id="ckeditor_instance_{$editor_sequence}" data-editor-sequence="{$editor_sequence}" data-editor-primary-key-name="{$editor_primary_key_name}" data-editor-content-key-name="{$editor_content_key_name}" style="min-height:{$editor_height}px;"></div>

<!--%load_js_plugin("jquery.fileupload")-->
<div cond="$allow_fileupload" id="xe-uploader-container-{$editor_sequence}" class="xe-uploader-container clearfix" data-editor-sequence="{$editor_sequence}">
	<div class="xe-uploader-preview">
		<img />
	</div>

	<div style="display:inline-block; vertical-align:top;">
		<div class="xe-uploader-filelist" style="">
			<select id="uploaded_file_list_{$editor_sequence}" multiple="multiple" class="" style="width: 300px;">
			</select>
		</div>

		<div style="display:inline-block;vertical-align:top;">
			<!-- PROGRESS -->
			<div id="progress" class="progress">
				<div class="progress-bar progress-bar-success"></div>
			</div>
			<!-- END:PROGRESS -->
			<div class="xe-fileupload-controll">
				<span class="btn fileinput-button">
					<span>{$lang->edit->upload_file}</span>
					<input id="xe-fileupload" type="file" class="fileupload-processing" name="Filedata" data-auto-upload="true" data-editor-sequence="{$editor_sequence}" multiple />
				</span>
				<button type="button" class="btn xe-act-delete-selected">{$lang->edit->delete_selected}</button>
				<button type="button" class="btn xe-act-link-selected">{$lang->edit->link_file}</button>
			</div>
			<div class="file_attach_info" style="display:inline-block;" id="uploader_status_{$editor_sequence}">{$upload_status}</div>
		</div>
	</div>
</div>

<script>
(function($){
	"use strict";

	// editor
	$(function(){
		var ckconfig = {
			height: '{$editor_height}',
			skin: '{$colorset}',
			contentsCss: '{$content_style_path}/editor.css',
			xe_editor_sequence: {$editor_sequence}
		};
		<!--@if($enable_component)-->
			ckconfig.extraPlugins = 'xe_component';

			{@ $xe_component = array(); }
			<!--@foreach($component_list as $component_name => $component)-->
				{@ $xe_component[] = $component_name . ":'" . $component->title . "'"; }
			<!--@endforeach-->
			{@ $xe_component = implode(',', $xe_component); }

			ckconfig.xe_component_arrays = {{$xe_component}};
		<!--@endif-->

		<!--@if(!$enable_default_component)-->
			ckconfig.toolbar = [];
			ckconfig.toolbarCanCollapse = false;
		<!--@endif-->

		<!--@if($module_type === 'comment')-->
			ckconfig.toolbarStartupExpanded = false;
		<!--@endif-->

		<!--@if($css_content)-->CKEDITOR.addCss('{$css_content}');<!--@end-->

		$('#ckeditor_instance_{$editor_sequence}').XeCkEditor({
			ckeconfig : ckconfig,
			content_field: jQuery('[name={$editor_content_key_name}]')
		});
	});

	// uploader
	<!--@if($allow_fileupload)-->
	$(function () {/**/
		var setting = {
			maxFileSize: {$file_config->allowed_filesize},
			limitMultiFileUploadSize: {$file_config->allowed_filesize}
		};
		var uploader = $('#xe-uploader-container-{$editor_sequence}').xeUploader(setting);
	});
	<!--@endif-->
})(jQuery);
</script>

<style>
.clearfix:before, .clearfix:after {
    content: "";
    display: table;
}

.clearfix:after {
    clear: both;
}

.clearfix {
    *zoom: 1;
}
</style>
